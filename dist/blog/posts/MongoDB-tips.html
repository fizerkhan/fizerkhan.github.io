<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/images/cabin.png">
    <link href="/styles/main.css" rel="stylesheet">
    <title>MongoDB tips</title>
  </head>
  <body>
    <nav id="nav">
      <h1 class="name"><a href="/">Fizer Khan</a></h1>
      <ul class="nav-links">
        <li class="menu icon-menu"></li>
        <li class="text-link"><a href="/about.html">About</a></li>
        <li class="text-link"><a href="/projects.html">Projects</a></li>
        <li class="text-link"><a href="/archives.html">Archives</a></li>
      </ul>
      <div class="social-media"><a href="https://github.com/fizerkhan" class="icon-github"></a><a href="https://twitter.com/fizerkhan" class="icon-twitter"></a><a href="http://facebook.com/fizerface" class="icon-facebook"></a></div>
    </nav>
    <div class="content">
      <div class="post-head group"><a href="/blog/posts/MongoDB-tips.html">
          <h1 class="post-title">MongoDB tips</h1></a>
        <h2 class="post-date">2013 &#183; 7 &#183; 2</h2>
      </div>
      <div class="post-body"><p><a href="http://www.mongodb.org/">MongoDB</a> becomes more popular among the developers because of its schemaless nature which give more flexibility. We can store any kind of data  without having to worry about the structure of the data.</p>
<p>For few operations, i went through lot of searches to get the correct solutions. Some of them are</p>
<ol>
<li>Renaming a field name</li>
<li>Change type of field value</li>
<li>Finding document if the field exists</li>
<li>Sucking MongoDB console</li>
</ol>
<p>Lets assume that you have a MongoDB collection <code>bookmarks</code> for Bookmarking application</p>
<pre><code><div class="highlight"><pre><span class="p">{</span>
  <span class="s1">&#39;name&#39;</span> <span class="o">:</span> <span class="s1">&#39;DIVE INTO HTML5&#39;</span><span class="p">,</span>
  <span class="s1">&#39;url&#39;</span> <span class="o">:</span> <span class="s1">&#39;http://diveintohtml5.info/index.html&#39;</span><span class="p">,</span>
  <span class="s1">&#39;author&#39;</span><span class="o">:</span> <span class="s1">&#39;MARK PILGRIM&#39;</span><span class="p">,</span>
  <span class="s1">&#39;upvote&#39;</span><span class="o">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>
  <span class="s1">&#39;created_at&#39;</span><span class="o">:</span> <span class="s2">&quot;2013-07-02 00:00:00&quot;</span>
<span class="p">}</span>
</pre></div>
</code></pre>
<a name="renaming-a-field-name" class="anchor" href="#renaming-a-field-name"><h3>Renaming a field name</h3>
</a><p>Let&#39;s say you want to rename a <code>name</code> filed to <code>title</code>, then</p>
<pre><code><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">bookmarks</span><span class="p">.</span><span class="nx">update</span><span class="p">({},</span> <span class="p">{</span> <span class="nx">$rename</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;title&quot;</span><span class="p">}},</span> <span class="p">{</span> <span class="nx">multi</span> <span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
</pre></div>
</code></pre>
<p>In above command, the option <code>multi</code> is important. Otherwise it will update only one document.</p>
<a name="change-type-of-field-value" class="anchor" href="#change-type-of-field-value"><h3>Change type of field value</h3>
</a><p>If you want to change type of <code>upvote</code> field from <code>string</code> to <code>number</code> value, then</p>
<pre><code><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">bookmarks</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">bookmark</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">bookmark</span><span class="p">.</span><span class="nx">upvote</span> <span class="o">=</span> <span class="o">+</span><span class="p">(</span><span class="nx">bookmark</span><span class="p">.</span><span class="nx">upvote</span><span class="p">);</span>  <span class="c1">// equivalent to parseInt</span>
  <span class="nx">db</span><span class="p">.</span><span class="nx">bookmarks</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">bookmark</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</code></pre>
<a name="finding-the-document-if-the-field-exists" class="anchor" href="#finding-the-document-if-the-field-exists"><h3>Finding the document if the field exists</h3>
</a><p> Some scenarios, you might want to find the document which has a specific fields.
 Lets say, get bookmarks which has <code>tags</code> field.</p>
<pre><code><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">bookmarks</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="nx">tags</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">$exists</span> <span class="o">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</code></pre>
<p>If the value of field is <code>null</code>, then the field is considered as Not exist.</p>
<a name="sucking-mongodb-console" class="anchor" href="#sucking-mongodb-console"><h3>Sucking MongoDB console</h3>
</a><p>MongoDB console sucks. I got frustrated  whenever i work with MongoDB console. I desperately need JSON pretty for console output, and some more useful commands. Then I found the <a href="https://github.com/TylerBrock/mongo-hacker">Mongo-hacker</a>  by
<a href="https://github.com/TylerBrock">TylerBrock</a>(Thanks bro). It is awesome and you must give a try.</p>
<p>Let me know if anything you got useful. Have a nice day.</p>
</div>
      <div class="social"><a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a><a href="https://twitter.com/share" data-via="fizerkhan" data-lang="en" class="twitter-share-button">Tweet</a>
        <div data-action="share" data-annotation="bubble" class="g-plus"></div>
      </div>
      <hr class="style-eight">
      <div id="comments">
        <div id="disqus_thread"></div>
      </div>
      <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'fizerkhan'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the<a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by<span class="logo-disqus">Disqus</span></a>
      <script>
        (function(d, t) {
          var g = d.createElement(t),
              s = d.getElementsByTagName(t)[0];
          g.src = '//hnbutton.appspot.com/static/hn.min.js';
          s.parentNode.insertBefore(g, s);
        }(document, 'script'));
      </script>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
      <script>
        (function() {
          var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
          po.src = 'https://apis.google.com/js/plusone.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
        
      </script>
    </div><a href="http://www.fizerkhan.com/"><img src="/images/cabin.png" class="cabin"></a>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
    <script src="/scripts/main.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-41972683-1', 'fizerkhan.com');
      ga('send', 'pageview');
    </script>
  </body>
</html>